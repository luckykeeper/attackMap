(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{596:function(t,s,a){"use strict";a.r(s);var n=a(11),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[t._v("本节将介绍如何进行二次开发，建议先了解前面的内容再看本节")])]),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),a("p",[t._v("在二次开发前，咱们先来再次回顾一下咱们这套系统的架构")]),t._v(" "),a("p",[t._v("如下图所示")]),t._v(" "),a("blockquote",[a("p",[a("img",{attrs:{src:"/attackMap/images/deployment/README/%E6%9E%B6%E6%9E%84%E5%B1%95%E7%A4%BA.PNG",alt:"架构展示"}})])]),t._v(" "),a("h2",{attrs:{id:"sysloger-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sysloger-模块"}},[t._v("#")]),t._v(" sysloger 模块")]),t._v(" "),a("p",[t._v("sysloger 模块是二次开发的重点，你只需要按照格式处理好数据送到 orgData/syslog 数据库内，就可以把你的数据源轻松纳入本套系统，后面 calcAttack 模块就会对数据进行统一整理，并交由 apiv1 模块向前段传数据")]),t._v(" "),a("h3",{attrs:{id:"数据要求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据要求"}},[t._v("#")]),t._v(" 数据要求")]),t._v(" "),a("p",[t._v("如下表，写入 MongoDB 的 orgData/syslog 中")]),t._v(" "),a("p",[t._v("以下均为 key_value 格式")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),t._v(" "),a("th",[t._v("说明")]),t._v(" "),a("th",[t._v("示例")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("srcIp")]),t._v(" "),a("td",[t._v("发起攻击的IP地址")]),t._v(" "),a("td",[t._v("177.20.249.60")])]),t._v(" "),a("tr",[a("td",[t._v("attackTime")]),t._v(" "),a("td",[t._v("发起攻击的时间")]),t._v(" "),a("td",[t._v("2022-03-20 18:11:54")])]),t._v(" "),a("tr",[a("td",[t._v("destName")]),t._v(" "),a("td",[t._v("攻击目标，对于蜜罐类数据源可以固定名称“蜜罐1号”，对于 WAF 类数据源可以展示 IP 地址，不做强制要求，不参与后续计算")]),t._v(" "),a("td",[t._v("见左")])]),t._v(" "),a("tr",[a("td",[t._v("destLocX")]),t._v(" "),a("td",[t._v("被攻击服务器的经度，请手动指定，不参与后续计算")]),t._v(" "),a("td",[t._v("115.506601")])]),t._v(" "),a("tr",[a("td",[t._v("destLocY")]),t._v(" "),a("td",[t._v("被攻击服务器的纬度，请手动指定，不参与后续计算")]),t._v(" "),a("td",[t._v("38.926478")])]),t._v(" "),a("tr",[a("td",[t._v("dataSource")]),t._v(" "),a("td",[t._v("数据来源，请根据数据实际来源填写，不参与后续计算")]),t._v(" "),a("td",[t._v("DPTECH")])]),t._v(" "),a("tr",[a("td",[t._v("atkType")]),t._v(" "),a("td",[t._v('攻击类型， WAF 类会传这样的数据过来，蜜罐类一般填写“ scan ”或者" attack "')]),t._v(" "),a("td",[t._v("Icmp unreach")])]),t._v(" "),a("tr",[a("td",[t._v("action")]),t._v(" "),a("td",[t._v('我方的相应动作， WAF 类会传这样的数据过来，蜜罐类一般填写"记录"')]),t._v(" "),a("td",[t._v("alert")])])])]),t._v(" "),a("p",[t._v("最终写入数据库数据示例如下")]),t._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'srcIp'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'106.118.146.113'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackTime'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2022-03-20 18:14:56'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destName'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'123.123.123.123'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destLocX'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'115.506601'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destLocY'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'38.926478'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dataSource'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DPTECH'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'atkType'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Icmp unreach'")]),t._v(", "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'action'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'alert'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h3",{attrs:{id:"基于-syslog-的二次开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于-syslog-的二次开发"}},[t._v("#")]),t._v(" 基于 syslog 的二次开发")]),t._v(" "),a("p",[t._v("如果你的数据源支持 syslog ，那二次开发就会非常容易，所以建议优先考虑 syslog")]),t._v(" "),a("h3",{attrs:{id:"step01-确定数据来源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step01-确定数据来源"}},[t._v("#")]),t._v(" Step01：确定数据来源")]),t._v(" "),a("p",[t._v("有多个数据来源的时候，区分不同的数据来源很有必要，可以方便后面的处理，就像垃圾分类一样，我们的第一步当然是要给进来的数据打上 Tag ，我们利用 re 库来识别，你需要写类似下面的代码")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 来自蜜罐的数据")]),t._v("\n\t\thoneypotRe "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'HFish'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 来自 WAF 的数据")]),t._v("\n\t\twafRe "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'DPTECH'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 判断蜜罐数据")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" honeypotRe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("orgData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"数据来自蜜罐!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打上蜜罐 Tag")]),t._v("\n\t\t\tdataTag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"honeypotTag"')]),t._v("\n\n\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 来自 WAF 的数据")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" wafRe"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("search"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("orgData"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("None")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"数据来自 WAF !"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 打上 WAF Tag")]),t._v("\n\t\t\tdataTag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"wafTag"')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("p",[t._v("二次开发时，你需要寻找数据源传来的独特数据，一般是系统名称，比如 '"),a("code",[t._v("HFish")]),t._v("' 这样的，然后给对应的数据打上 Tag ，不同的 Tag 对应后面不同的数据处理动作")]),t._v(" "),a("h3",{attrs:{id:"step02-处理数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step02-处理数据"}},[t._v("#")]),t._v(" Step02：处理数据")]),t._v(" "),a("p",[t._v("按照上面的数据要求处理数据成为指定格式即可，通常使用 .split 方法对文本进行分割，这部分的写法详见源码")]),t._v(" "),a("h3",{attrs:{id:"step03-写入数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step03-写入数据库"}},[t._v("#")]),t._v(" Step03：写入数据库")]),t._v(" "),a("p",[t._v("如下，非常简单")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 整理将要写入数据库的数据")]),t._v("\n\t\t\tresult_db "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'srcIp'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" srcIp\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'attackTime'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" attackTime\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destName'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" destName\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destLocX'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" destLocX\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'destLocY'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" destLocY\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dataSource'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" dataSource\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'atkType'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" atkType\n\t\t\tresult_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'action'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" action\n\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## Debug 输出将要写入数据库的数据")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"将要写入数据库的数据"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("result_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 数据统一写入 MongoDB 的 orgData/syslog 数据库")]),t._v("\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\tclient "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" MongoClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MongoDB_host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MongoDB_port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\tdb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("admin    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 先连接系统默认数据库admin进行认证")]),t._v("\n\t\t\t\tdb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("authenticate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MongoDB_user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MongoDB_password"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mechanism"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SCRAM-SHA-1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('">>>>>>MongoDB数据库连接成功!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\tnewDb "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MongoDB_dbName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t\t\t\tnewCol "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newDb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("MongoDB_col"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\t\t\t\tnewCol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("insert_one"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("result_db"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" debug "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"数据成功写入!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n\t\t\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("print")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"请检查数据库设定是否正确!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br")])]),a("h3",{attrs:{id:"基于其它数据库的二次开发"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于其它数据库的二次开发"}},[t._v("#")]),t._v(" 基于其它数据库的二次开发")]),t._v(" "),a("p",[t._v("方法和上面一样，我原先在 HFish 不支持 syslog 的时候，写过从它的 sqlite 数据库提数据的程序，非常简单")]),t._v(" "),a("h2",{attrs:{id:"calcattack-模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calcattack-模块"}},[t._v("#")]),t._v(" calcAttack 模块")]),t._v(" "),a("p",[t._v("这个模块负责信息的统一计算，你可能会想要修改其中的一些参数")]),t._v(" "),a("p",[t._v("因为这套系统是给学校开发的，学校比较大， 192.168.0.0/16 段全部都用上了，所以程序会让 192.168.0.0/16 段全部返回的位置是“局域网”，你可能会需要修改这里，这里模块是用正则表达式判断的，你需要先学习怎么写正则表达式")]),t._v(" "),a("p",[t._v("模块中判断 192.168.0.0/16 段的代码如下")]),t._v(" "),a("div",{staticClass:"language-python line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[t._v("pattern "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" re"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("compile")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'(?:(?:10(?:(?:\\.1[0-9][0-9])|(?:\\.2[0-4][0-9])|(?:\\.25[0-5])|(?:\\.[1-9][0-9])|(?:\\.[0-9])))|(?:172(?:\\.(?:1[6-9])|(?:2[0-9])|(?:3[0-1])))|(?:192\\.168))(?:(?:\\.1[0-9][0-9])|(?:\\.2[0-4][0-9])|(?:\\.25[0-5])|(?:\\.[1-9][0-9])|(?:\\.[0-9])){2}'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("h2",{attrs:{id:"其它模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其它模块"}},[t._v("#")]),t._v(" 其它模块")]),t._v(" "),a("p",[t._v("一般来说，其它模块应该没有什么开发需求，相互依赖性也不强，开发其它模块请直接起个新的文件来写")])])}),[],!1,null,null,null);s.default=e.exports}}]);